# 正規表現

学習者：m.sasaki

### 正規表現の利用例
- バリデーション
  - 入力された文字列が期待通りの形式か
    - 例：
      - メールアドレスの欄に電話番号を入力していないか
- 抽出
  - 大量のテキストデータから参照したい部分だけを抽出
    - 例：
      - アクセスログからIPアドレスだけを抽出

<br>

- **基本的な正規表現: 選択・グループ**
  - 「|（パイプ）」区切りでどれかにマッチさせる
    - 例：
      - com | jp
        - google.<font color="red">com</font>
        - yahoo.<font color="red">jp</font>
  - 「()」で選択範囲を限定する
    - 例：
      - (google | yahoo)
        - <font color="red">google</font>.com
        - <font color="red">yahoo</font>.jp

<br>

**基本的な正規表現(個別調査)**

| 文字 | 意味 | 正規表現の例 | マッチする文字列 |
| :----: | :----:| :----: | :----: |
| . | 任意の1文字にマッチ | . | A<br>あ |
| + | 直前の1文字が1回以上繰り返す場合にマッチ<br>**最長一致**。条件に合う最長の部分にマッチ | go+gle | gogle<br>goooogle |
| * | 直前の文字が0回以上繰り返す場合にマッチ<br>**最長一致**。条件に合う最長の部分にマッチ | go*gle | ggle<br>goooogle |
| ? | 直前の文字が0個か1個の場合にマッチ<br>**最長一致**。条件に合う最長の部分にマッチ | go?gle | ggle<br>gogle |
| +? | 直前の文字が1回以上繰り返す場合にマッチ<br>**最短一致** | go+?gle | gogle<br>goooogle |
| *? | 直前の文字が0回以上繰り返す場合にマッチ<br>**最短一致** | go*?gle | ggle<br>goooogle |
| ?? | 直前の文字が0個か1個下の場合にマッチ<br>**最短一致** | go??gle | ggle<br>gogle |
| &#124; | **いずれかの条件(OR条件)**として使用 | goog(le&#124;ol) | google<br>Googol |
| \ | 直後の正規表現記号をエスケープ | go\+gle | go+gle |
| [...] | 角括弧に含まれるいずれか1文字にマッチ | [abc] <br> [a-c] | a,b,c |
| [^...] | 角括弧内に含まれる文字以外にマッチ | [^abc] <br> [^a-c] | a,b,c以外 |
| (...) | 文字を1つのグループにまとめる | goog(le&#124;ol) | google<br>Googol |
| {n} | 直前の文字の桁数を指定 | a{3} | aaa |
| {n,} | 直前の文字の最小桁数のみ指定 | a{3,} | aaa<br>aaaaaaaaa |
| {n, m} | 直前の文字の最小桁数（n）と最大桁数（m）を指定<br>**最長一致** | a{3,4} | aaa<br>aaaa |
| {n, m}? | 直前の文字の最小桁数（n）と最大桁数（m）を指定<br>**最短一致** | a{3,4}? | aaa<br>aaaa |

<br>

**定義済みの正規表現**

| 文字 | 意味 | 対応する表現 |
| :----: | :----:| :----: |
| \t | タブ | なし |
| \r | 改行（CR） | なし |
| \n | 改行（LF） | なし |
| \d | 全ての数字 | [0-9] |
| \D | 全ての数字以外 | [^0-9] |
| \s | 垂直タブ以外の全ての空白文字 | [\t\f\r\n] |
| \S | 全ての非空白文字 | [^\t\f\r\n] |
| \w | アルファベット、アンダーバー、数字 | [a-zA-Z_0-9] |
| \W | アルファベット、アンダーバー、数字以外の文字 | [^a-zA-Z_0-9] |

**特定の位置関係の正規表現**

| 文字 | 意味 | 正規表現の例 | マッチする文字列 |
| :----: | :----:| :----: | :----: |
| ^ | 直前の文字が行の**先頭**にある場合にマッチ | ^google | google... |
| $ | 直前の文字が行の**末尾**にある場合にマッチ | google$ | ...google |
| \\< | 単語の先頭にマッチ | \\< | *google |
| \\> | 単語の末尾にマッチ | \\> | google* |
| \b | 単語の先頭か末尾にマッチ | \b | \*google\* |
| \B | 単語の先頭か末尾以外にマッチ | \B | google |
| \A | ファイルの先頭にマッチ | \A | なし |
| \z | ファイルの末尾にマッチ | \z | なし |
| \G | 直前の一致文字列の末尾にマッチ | \G | なし |