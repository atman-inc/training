# 8章 意味のあるモデルで複雑さを扱う

担当: @y-kaneda

## まとめ

_この章では“設計を見通すのに役立つ、意味のあるモデルを作成する方法を学んでいく_  
  
### アーキテクチャを見通す
- 抽象概念を用い、他の部分を気にせず特定の詳細についてのみ関心を持つ
- きちんと抽象概念を共有できるよう、有用なアーキテクチャのモデルを作ることを考える
- 優れたアーキテクチャモデルの利点
    - 設計の語彙を確立する
    - 関心を持つべき細部に注意を向ける
    - 品質特性やその他のシステム特性を見通せる
    - アーキテクトの意図を記録できる

#### メタモデルを記述する
- モデルで仕様される概念(アーキテクチャにおける要素や関係)とそれらの概念を適用するための規則を定義する
- まず概念を定義し、概念を使用するための規則を設定する
    - **新しい概念を個体化する**
        - 概念の個体化
            - アイデアを互いに異なるものとして認識する認知プロセス
        - 好奇心のサイクル
            - 問いかけ → テスト → 既存モデルの強化 or モデル変更
        - 概念を個体化できるだけの引き出しを持っていないリスクもあるが、アーキテクチャパターン等の既存のメタモデルを使ってこのリスクを軽減することができる
    - **アーキテクチャの芽となるパターンを選ぶ**
        - 全てのデザインは再デザインであり、ほとんどのアーキテクチャには既存パターンが含まれている
        - 適切なパターンを選択していればメタモデルは既に手に入っている
        - メタモデルに新たな概念を追加すると
    - **矛盾を調整する**
        - パターンのマージなどによってメタモデルを統合すると、それぞれで重複する要素の定義や規則が異なっていて矛盾が生じることがある
        - 類似した概念はマージし、同名で異なる概念のものは名前を分けて区別したりする
        - メタモデルに新しい概念を追加した場合には規則も更新する必要がある
    - **良い名前を使う**
        - 名付けの7段階
            - 対象への理解度による名付けのレベル

#### コード内にモデルを構築する
- モデルは直接コードになるものでは無いので、コードに入らず無駄になってしまうことがある
    - **アーキテクチャの語彙を適用する**
        - アーキテクチャパターンの用語をパッケージやクラス名の命名に使用する
        - ドメイン語と合わせた名前をつける
    - **パターンを分かりやすくするためにコードを整理する**
        - クラスが1ファイルに複数書かれていても整理されたディレクトリのファイルに分かれていてもコンパイラは同じように解釈できる
        - 設計されたモジュール構造と一致するようにコードを整理する
        - コードベースからパターンが見えないということはパターンが存在しないことになる
    - **要素間の関係を強制する**
        - 規律に頼るだけではなく、コード内でアーキテクチャを強制する方法を取る
        - モジュール構造
            - 見やすいが強制するのが難しい
            - モジュールへのアクセスを制限するか、ライブラリとしてモジュールを配布する
        - コンポーネント＆コネクター (C&C) 構造
            - アーキテクチャに違反したときにシステムが素早く失敗するように設計する
            - 接続されるべきではないコンポーネント間での接続を防ぐ
        - 割り当て構造
            - Paas や Docker、Infrastructure as Code 等を用いて、コードで割り当てモデルを記述して強制できる
            - ハードウェア割り当ての制限をテストすることが可能
    - **コメントとしてヒントをつける**
        - コード構造で設計判断を強制することはできるが、その判断理由は表せない
        - 設計根拠を説明するコメントや、既存の設計資料へのリンクをいれる
        - 例外メッセージを具体的な説明にする
    - **コードからモデルを生成する**
        - コードからクラス図やパッケージ図を生成し、モジュール構造を分析できる
        - C&C構造を生成するには実行時モデルを観察できるような制御が必要

## 分かってないこと

- 特にないです

## ディスカッション

- ございません・・・
